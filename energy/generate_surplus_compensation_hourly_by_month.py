# Iterate by every day of the month

    # Iterate by every hour of the day        

    # Get the aggregated consumption for all CUPS for that hour

    # Get the aggregated surplus for all CUPS for that hour

    # Remove the surplus to the consumption

    # Get the production for that hour

    # Remove the total consumption to the production

    # Get the price for that hour

    # Multiply the calculated consumption by the price